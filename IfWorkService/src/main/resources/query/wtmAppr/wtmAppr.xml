<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.isu.ifw.mapper.WtmFlexibleApprMapper">
	<select id="getApprList" parameterType="map" resultType="hashmap">
        <![CDATA[
			SELECT L.APPL_ID AS applId
			     , L.APPR_SABUN AS apprSabun
			     , L.APPR_DATE AS apprDate
			     , L.APPL_STATUS_CD AS applStatusCd
			     , L.APPL_TYPE_CD AS applTypeCd
			     , L.APPR_OPINION AS apprOpinion
			     , C.APPL_CD AS applCd
			     , C.APPL_NM AS applNm
			     , A.APPL_SABUN AS applSabun
			     , F_GET_EMP_NM(A.TENANT_ID, A.ENTER_CD, A.APPL_SABUN, A.APPL_YMD ) AS empNm
			     , A.APPL_YMD AS applYmd
			     , A.APPL_IN_SABUN AS applInSabun
			     , A.APPL_STATUS_CD AS applStatusCd
			     , F_GET_CODE_NM(A.TENANT_ID, A.ENTER_CD, 'APPL_STATUS_CD', A.APPL_STATUS_CD, A.APPL_YMD) AS applStatusNm
			     , FA.FLEXIBLE_APPL_ID AS flexibleApplId
			     , FA.FLEXIBLE_STD_MGR_ID AS flexibleStdMgrId
			     , F_DATE_FORMAT(FA.SYMD,'%Y.%m.%d') AS sYmd
			     , F_DATE_FORMAT(FA.EYMD,'%Y.%m.%d') AS eYmd
			     , FA.WORK_DAY AS workDay
			     , FA.REASON AS reason
			  FROM WTM_APPL_LINE L
			  JOIN WTM_APPL A
			    ON L.APPL_ID = A.APPL_ID
			  JOIN WTM_APPL_CODE C
			    ON A.TENANT_ID = C.TENANT_ID
			   AND A.ENTER_CD = C.ENTER_CD
			   AND A.APPL_CD = C.APPL_CD
			  JOIN WTM_FLEXIBLE_APPL FA
			    ON A.APPL_ID = FA.APPL_ID
			 WHERE A.TENANT_ID = #{tenantId}
			   AND A.ENTER_CD = #{enterCd}
			   AND APPR_SABUN = #{empNo}
        ]]>
    </select>
</mapper>
