{"version":3,"file":"vue-upload-component.min.js","sources":["../src/InputFile.vue","../src/FileUpload.vue"],"sourcesContent":["<template>\n  <input\n    type=\"file\"\n    :name=\"$parent.name\"\n    :id=\"$parent.inputId || $parent.name\"\n    :accept=\"$parent.accept\"\n    @change=\"change\"\n    :webkitdirectory=\"$parent.directory && $parent.features.directory\"\n    :directory=\"$parent.directory && $parent.features.directory\"\n    :multiple=\"$parent.multiple && $parent.features.html5\"\n  />\n</template>\n<script>\nexport default {\n  methods: {\n    change(e) {\n      this.$destroy()\n      this.$parent.addInputFile(e.target)\n      // eslint-disable-next-line\n      new this.constructor({\n        parent: this.$parent,\n        el: this.$el,\n      })\n    }\n  }\n}\n</script>\n","<template>\n  <label :class=\"className\">\n    <slot></slot>\n    <input-file></input-file>\n  </label>\n</template>\n<style>\n.file-uploads {\n  overflow: hidden;\n  position: relative;\n  text-align: center;\n  display: inline-block;\n}\n.file-uploads.file-uploads-html4 input[type=\"file\"] {\n  opacity: 0;\n  font-size: 20em;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n}\n.file-uploads.file-uploads-html5 input[type=\"file\"] {\n  overflow: hidden;\n  position: fixed;\n  width: 1px;\n  height: 1px;\n  z-index: -1;\n  opacity: 0;\n}\n</style>\n<script>\nimport InputFile from './InputFile.vue'\nexport default {\n  components: {\n    InputFile,\n  },\n  props: {\n    inputId: {\n      type: String,\n    },\n\n    name: {\n      type: String,\n      default: 'file',\n    },\n\n    accept: {\n      type: String,\n    },\n\n    multiple: {\n      type: Boolean,\n    },\n\n    maximum: {\n      type: Number,\n      default() {\n        return this.multiple ? 0 : 1\n      }\n    },\n\n    addIndex: {\n      type: [Boolean, Number],\n    },\n\n    directory: {\n      type: Boolean,\n    },\n\n    postAction: {\n      type: String,\n    },\n\n    putAction: {\n      type: String,\n    },\n\n    headers: {\n      type: Object,\n      default: Object,\n    },\n\n    data: {\n      type: Object,\n      default: Object,\n    },\n\n    timeout: {\n      type: Number,\n      default: 0,\n    },\n\n\n    drop: {\n      default: false,\n    },\n\n    dropDirectory: {\n      type: Boolean,\n      default: true,\n    },\n\n    size: {\n      type: Number,\n      default: 0,\n    },\n\n    extensions: {\n      default: Array,\n    },\n\n\n    value: {\n      type: Array,\n      default: Array,\n    },\n\n    thread: {\n      type: Number,\n      default: 1,\n    },\n  },\n\n  data() {\n    return {\n      files: this.value,\n      features: {\n        html5: true,\n        directory: false,\n        drag: false,\n      },\n\n      active: false,\n      dropActive: false,\n\n      uploading: 0,\n\n      destroy: false,\n    }\n  },\n\n\n  /**\n   * mounted\n   * @return {[type]} [description]\n   */\n  mounted() {\n    let input = document.createElement('input')\n    input.type = 'file'\n    input.multiple = true\n\n    // html5 特征\n    if (window.FormData && input.files) {\n      // 上传目录特征\n      if (typeof input.webkitdirectory === 'boolean' || typeof input.directory === 'boolean') {\n        this.features.directory = true\n      }\n\n      // 拖拽特征\n      if (this.features.html5 && typeof input.ondrop !== 'undefined') {\n        this.features.drop = true\n      }\n    } else {\n      this.features.html5 = false\n    }\n\n    // files 定位缓存\n    this.maps = {}\n\n    this.$nextTick(function () {\n\n      // 更新下父级\n      if (this.$parent) {\n        this.$parent.$forceUpdate()\n      }\n\n      // 拖拽渲染\n      this.watchDrop(this.drop)\n    })\n  },\n\n  /**\n   * beforeDestroy\n   * @return {[type]} [description]\n   */\n  beforeDestroy() {\n    // 已销毁\n    this.destroy = true\n\n    // 设置成不激活\n    this.active = false\n  },\n\n  computed: {\n    /**\n     * uploading 正在上传的线程\n     * @return {[type]} [description]\n     */\n\n    /**\n     * uploaded 文件列表是否全部已上传\n     * @return {[type]} [description]\n     */\n    uploaded() {\n      let file\n      for (let i = 0; i < this.files.length; i++) {\n        file = this.files[i]\n        if (file.fileObject && !file.error && !file.success) {\n          return false\n        }\n      }\n      return true\n    },\n\n\n    className() {\n      return [\n        'file-uploads',\n        this.features.html5 ? 'file-uploads-html5' : 'file-uploads-html4',\n        this.features.directory && this.directory ? 'file-uploads-directory' : undefined,\n        this.features.drop && this.drop ? 'file-uploads-drop' : undefined,\n      ]\n    }\n  },\n\n\n  watch: {\n    active(active) {\n      this.watchActive(active)\n    },\n\n    dropActive() {\n      if (this.$parent) {\n        this.$parent.$forceUpdate()\n      }\n    },\n\n    drop(value) {\n      this.watchDrop(value)\n    },\n\n    value(files) {\n      if (this.files === files) {\n        return\n      }\n      this.files = files\n\n      let oldMaps = this.maps\n\n      // 重写 maps 缓存\n      this.maps = {}\n      for (let i = 0; i < this.files.length; i++) {\n        let file = this.files[i]\n        this.maps[file.id] = file\n      }\n\n      // add, update\n      for (let key in this.maps) {\n        let newFile = this.maps[key]\n        let oldFile = oldMaps[key]\n        if (newFile !== oldFile) {\n          this.emitFile(newFile, oldFile)\n        }\n      }\n\n      // delete\n      for (let key in oldMaps) {\n        if (!this.maps[key]) {\n          this.emitFile(undefined, oldMaps[key])\n        }\n      }\n    },\n  },\n\n  methods: {\n\n    // 清空\n    clear() {\n      if (this.files.length) {\n        let files = this.files\n        this.files = []\n\n        // 定位\n        this.maps = {}\n\n        // 事件\n        this.emitInput()\n        for (let i = 0; i < files.length; i++) {\n          this.emitFile(undefined, files[i])\n        }\n      }\n      return true\n    },\n\n    // 选择\n    get(id) {\n      if (!id) {\n        return false\n      }\n\n      if (typeof id === 'object') {\n        return this.maps[id.id] || false\n      }\n\n      return this.maps[id] || false\n    },\n\n    // 添加\n    add(_files, index = this.addIndex) {\n      let files = _files\n      let isArray = files instanceof Array\n\n      // 不是数组整理成数组\n      if (!isArray) {\n        files = [files]\n      }\n\n      // 遍历规范对象\n      let addFiles = []\n      for (let i = 0; i < files.length; i++) {\n        let file = files[i]\n        if (this.features.html5 && file instanceof Blob) {\n          file = {\n            file,\n            size: file.size,\n            name: file.webkitRelativePath || file.relativePath || file.name || 'unknown',\n            type: file.type,\n          }\n        }\n        let fileObject = false\n        if (file.fileObject === false) {\n          // false\n        } else if (file.fileObject) {\n          fileObject = true\n        } else if (typeof Element !== 'undefined' && file.el instanceof Element) {\n          fileObject = true\n        } else if (typeof Blob !== 'undefined' && file.file instanceof Blob) {\n          fileObject = true\n        }\n        if (fileObject) {\n          file = {\n            fileObject: true,\n            size: -1,\n            name: 'Filename',\n            type: '',\n            active: false,\n            error: '',\n            success: false,\n            putAction: this.putAction,\n            postAction: this.postAction,\n            timeout: this.timeout,\n            ...file,\n            response: {},\n\n            progress: '0.00',          // 只读\n            speed: 0,                  // 只读\n            // xhr: false,                // 只读\n            // iframe: false,             // 只读\n          }\n\n          file.data = {\n            ...this.data,\n            ...file.data ? file.data : {},\n          }\n\n          file.headers = {\n            ...this.headers,\n            ...file.headers ? file.headers : {},\n          }\n        }\n\n        // 必须包含 id\n        if (!file.id) {\n          file.id = Math.random().toString(36).substr(2)\n        }\n\n        if (this.emitFilter(file, undefined)) {\n          continue\n        }\n\n        // 最大数量限制\n        if (this.maximum > 1 && (addFiles.length + this.files.length) >= this.maximum) {\n          break\n        }\n\n        addFiles.push(file)\n\n        // 最大数量限制\n        if (this.maximum === 1) {\n          break\n        }\n      }\n\n      // 没有文件\n      if (!addFiles.length) {\n        return false\n      }\n\n      // 如果是 1 清空\n      if (this.maximum === 1) {\n        this.clear()\n      }\n\n\n      // 添加进去 files\n      let newFiles\n      if (index === true || index === 0) {\n        newFiles = addFiles.concat(this.files)\n      } else if (index) {\n        newFiles = addFiles.concat([])\n        newFiles.splice(index, 0, addFiles)\n      } else {\n        newFiles = this.files.concat(addFiles)\n      }\n\n      this.files = newFiles\n\n      // 定位\n      for (let i = 0; i < addFiles.length; i++) {\n        let file = addFiles[i]\n        this.maps[file.id] = file\n      }\n\n      // 事件\n      this.emitInput()\n      for (let i = 0; i < addFiles.length; i++) {\n        this.emitFile(addFiles[i], undefined)\n      }\n\n      return isArray ? addFiles : addFiles[0]\n    },\n\n\n\n    // 添加表单文件\n    addInputFile(el) {\n      let files = []\n      if (el.files) {\n        for (let i = 0; i < el.files.length; i++) {\n          let file = el.files[i]\n          files.push({\n            size: file.size,\n            name: file.webkitRelativePath || file.relativePath || file.name,\n            type: file.type,\n            file,\n            el\n          })\n        }\n      } else {\n        files.push({\n          name: el.value.replace(/^.*?([^\\/\\\\\\r\\n]+)$/, '$1'),\n          el,\n        })\n      }\n      return this.add(files)\n    },\n\n\n    // 添加 DataTransfer\n    addDataTransfer(dataTransfer) {\n      let files = []\n      if (dataTransfer.items && dataTransfer.items.length) {\n        let items = []\n        for (let i = 0; i < dataTransfer.items.length; i++) {\n          let item = dataTransfer.items[i]\n          if (item.getAsEntry) {\n            item = item.getAsEntry()\n          } else if (item.webkitGetAsEntry) {\n            item = item.webkitGetAsEntry()\n          } else {\n            item = item.getAsFile()\n          }\n          if (item) {\n            items.push(item)\n          }\n        }\n\n        return new Promise((resolve, reject) => {\n          let forEach = (i) => {\n            let item = items[i]\n            // 结束 文件数量大于 最大数量\n            if (!item || (this.maximum > 0 && files.length >= this.maximum)) {\n              return resolve(this.add(files))\n            }\n            this.getEntry(item).then(function (results) {\n              files.push(...results)\n              forEach(i + 1)\n            })\n          }\n          forEach(0)\n        })\n      }\n\n      if (dataTransfer.files.length) {\n        for (let i = 0; i < dataTransfer.files.length; i++) {\n          files.push(dataTransfer.files[i])\n          if (this.maximum > 0 && files.length >= this.maximum) {\n            break\n          }\n        }\n        return Promise.resolve(this.add(files))\n      }\n\n      return Promise.resolve([])\n    },\n\n\n    // 获得 entry\n    getEntry(entry, path = '') {\n      return new Promise((resolve, reject) => {\n        if (entry.isFile) {\n          entry.file(function (file) {\n            resolve([\n              {\n                size: file.size,\n                name: path + file.name,\n                type: file.type,\n                file,\n              }\n            ])\n          })\n        } else if (entry.isDirectory && this.dropDirectory) {\n          let files = []\n          let dirReader = entry.createReader()\n          let readEntries = () => {\n            dirReader.readEntries((entries) => {\n              let forEach = (i) => {\n                if ((!entries[i] && i === 0) || (this.maximum > 0 && files.length >= this.maximum)) {\n                  return resolve(files)\n                }\n                if (!entries[i]) {\n                  return readEntries()\n                }\n                this.getEntry(entries[i], path + entry.name + '/').then((results) => {\n                  files.push(...results)\n                  forEach(i + 1)\n                })\n              }\n              forEach(0)\n            })\n          }\n          readEntries()\n        } else {\n          resolve([])\n        }\n      })\n    },\n\n\n    replace(id1, id2) {\n      let file1 = this.get(id1)\n      let file2 = this.get(id2)\n      if (!file1 || !file2 || file1 === file2) {\n        return false\n      }\n      let files = this.files.concat([])\n      let index1 = files.indexOf(file1)\n      let index2 = files.indexOf(file2)\n      if (index1 === -1 || index2 === -1) {\n        return false\n      }\n      files[index1] = file2\n      files[index2] = file1\n      this.files = files\n      this.emitInput()\n      return true\n    },\n\n    // 移除\n    remove(id) {\n      let file = this.get(id)\n      if (file) {\n        if (this.emitFilter(undefined, file)) {\n          return false\n        }\n        let files = this.files.concat([])\n        let index = files.indexOf(file)\n        if (index === -1) {\n          console.error('remove', file)\n          return false\n        }\n        files.splice(index, 1)\n        this.files = files\n\n        // 定位\n        delete this.maps[file.id]\n\n        // 事件\n        this.emitInput()\n        this.emitFile(undefined, file)\n      }\n      return file\n    },\n\n    // 更新\n    update(id, data) {\n      let file = this.get(id)\n      if (file) {\n        let newFile = {\n          ...file,\n          ...data\n        }\n        // 停用必须加上错误\n        if (file.fileObject && file.active && !newFile.active && !newFile.error && !newFile.success) {\n          newFile.error = 'abort'\n        }\n\n        if (this.emitFilter(newFile, file)) {\n          return false\n        }\n\n        let files = this.files.concat([])\n        let index = files.indexOf(file)\n        if (index === -1) {\n          console.error('update', file)\n          return false\n        }\n        files.splice(index, 1, newFile)\n        this.files = files\n\n        // 删除  旧定位 写入 新定位 （已便支持修改id)\n        delete this.maps[file.id]\n        this.maps[newFile.id] = newFile\n\n        // 事件\n        this.emitInput()\n        this.emitFile(newFile, file)\n        return newFile\n      }\n      return false\n    },\n\n\n\n    // 预处理 事件 过滤器\n    emitFilter(newFile, oldFile) {\n      let isPrevent = false\n      this.$emit('input-filter', newFile, oldFile, function () {\n        isPrevent = true\n        return isPrevent\n      })\n      return isPrevent\n    },\n\n    // 处理后 事件 分发\n    emitFile(newFile, oldFile) {\n      this.$emit('input-file', newFile, oldFile)\n      if (newFile && newFile.fileObject && newFile.active && (!oldFile || !oldFile.active)) {\n        this.uploading++\n        // 激活\n        this.$nextTick(function () {\n          setTimeout(() => {\n            this.upload(newFile).then(() => {\n              // eslint-disable-next-line\n              newFile = this.get(newFile)\n              if (newFile && newFile.fileObject) {\n                this.update(newFile, {\n                  active: false,\n                  success: !newFile.error\n                })\n              }\n            }).catch((e) => {\n              this.update(newFile, {\n                active: false,\n                success: false,\n                error: e.code || e.error || e.message || e\n              })\n            })\n          }, parseInt(Math.random() * 50 + 50, 10))\n        })\n      } else if ((!newFile || !newFile.fileObject || !newFile.active) && oldFile && oldFile.fileObject && oldFile.active) {\n        // 停止\n        this.uploading--\n      }\n\n      // 自动延续激活\n      if (this.active && (Boolean(newFile) !== Boolean(oldFile) || newFile.active !== oldFile.active)) {\n        this.watchActive(true)\n      }\n    },\n\n    emitInput() {\n      this.$emit('input', this.files)\n    },\n\n\n    // 上传\n    upload(id) {\n      let file = this.get(id)\n\n      // 被删除\n      if (!file) {\n        return Promise.reject('not_exists')\n      }\n\n      // 不是文件对象\n      if (!file.fileObject) {\n        return Promise.reject('file_object')\n      }\n\n      // 有错误直接响应\n      if (file.error) {\n        return Promise.reject(file.error)\n      }\n\n      // 已完成直接响应\n      if (file.success) {\n        return Promise.resolve(file)\n      }\n\n      // 后缀\n      let extensions = this.extensions\n      if (extensions && (extensions.length || typeof extensions.length === 'undefined')) {\n        if (typeof extensions !== 'object' || !(extensions instanceof RegExp)) {\n          if (typeof extensions === 'string') {\n            extensions = extensions.split(',').map(value => value.trim()).filter(value => value)\n          }\n          extensions = new RegExp('\\\\.(' + extensions.join('|').replace(/\\./g, '\\\\.') + ')$', 'i')\n        }\n        if (file.name.search(extensions) === -1) {\n          return Promise.reject('extension')\n        }\n      }\n\n      // 大小\n      if (this.size > 0 && file.size >= 0 && file.size > this.size) {\n        return Promise.reject('size')\n      }\n\n\n      if (this.features.html5 && file.putAction) {\n        return this.uploadPut(file)\n      } else if (this.features.html5) {\n        return this.uploadHtml5(file)\n      } else {\n        return this.uploadHtml4(file)\n      }\n    },\n\n    uploadPut(file) {\n      let querys = []\n      let value\n      for (let key in file.data) {\n        value = file.data[key]\n        if (value !== null && value !== undefined) {\n          querys.push(encodeURIComponent(key) + '=' + encodeURIComponent(value))\n        }\n      }\n      let queryString = querys.length ? (file.putAction.indexOf('?') === -1 ? '?' : '&') + querys.join('&') : ''\n      let xhr = new XMLHttpRequest()\n      xhr.open('PUT', file.putAction + queryString)\n      return this.uploadXhr(xhr, file, file.file)\n    },\n\n    uploadHtml5(file) {\n      let form = new window.FormData()\n      let value\n      for (let key in file.data) {\n        value = file.data[key]\n        if (value && typeof value === 'object' && typeof value.toString !== 'function') {\n          if (value instanceof File) {\n            form.append(key, value, value.name)\n          } else {\n            form.append(key, JSON.stringify(value))\n          }\n        } else if (value !== null && value !== undefined) {\n          form.append(key, value)\n        }\n      }\n      form.append(this.name, file.file, file.file.filename || file.name)\n      let xhr = new XMLHttpRequest()\n      xhr.open('POST', file.postAction)\n      return this.uploadXhr(xhr, file, form)\n    },\n\n    uploadXhr(xhr, _file, body) {\n      let file = _file\n      let speedTime = 0\n      let speedLoaded = 0\n\n      // 进度条\n      xhr.upload.onprogress = (e) => {\n        // 还未开始上传 已删除 未激活\n        file = this.get(file)\n        if (!e.lengthComputable || !file || !file.fileObject || !file.active) {\n          return\n        }\n\n        // 进度 速度 每秒更新一次\n        let speedTime2 = Math.round(Date.now() / 1000)\n        if (speedTime2 === speedTime) {\n          return\n        }\n        speedTime = speedTime2\n\n        file = this.update(file, {\n          progress: (e.loaded / e.total * 100).toFixed(2),\n          speed: e.loaded - speedLoaded,\n        })\n        speedLoaded = e.loaded\n      }\n\n      // 检查激活状态\n      let interval = setInterval(() => {\n        file = this.get(file)\n        if (file && file.fileObject && !file.success && !file.error && file.active) {\n          return\n        }\n\n        if (interval) {\n          clearInterval(interval)\n          interval = false\n        }\n\n        try {\n          xhr.abort()\n          xhr.timeout = 1\n        } catch (e) {\n        }\n      }, 100)\n\n      return new Promise((resolve, reject) => {\n        let complete\n        let fn = (e) => {\n          // 已经处理过了\n          if (complete) {\n            return\n          }\n          complete = true\n          if (interval) {\n            clearInterval(interval)\n            interval = false\n          }\n\n          file = this.get(file)\n\n          // 不存在直接响应\n          if (!file) {\n            return reject('not_exists')\n          }\n\n          // 不是文件对象\n          if (!file.fileObject) {\n            return reject('file_object')\n          }\n\n          // 有错误自动响应\n          if (file.error) {\n            return reject(file.error)\n          }\n\n          // 未激活\n          if (!file.active) {\n            return reject('abort')\n          }\n\n\n          // 已完成 直接相应\n          if (file.success) {\n            return resolve(file)\n          }\n\n          let data = {}\n\n          switch (e.type) {\n            case 'timeout':\n            case 'abort':\n              data.error = e.type\n              break\n            case 'error':\n              if (!xhr.status) {\n                data.error = 'network'\n              } else if (xhr.status >= 500) {\n                data.error = 'server'\n              } else if (xhr.status >= 400) {\n                data.error = 'denied'\n              }\n              break\n            default:\n              if (xhr.status >= 500) {\n                data.error = 'server'\n              } else if (xhr.status >= 400) {\n                data.error = 'denied'\n              } else {\n                data.progress = '100.00'\n              }\n          }\n\n          if (xhr.responseText) {\n            let contentType = xhr.getResponseHeader('Content-Type')\n            if (contentType && contentType.indexOf('/json') !== -1) {\n              data.response = JSON.parse(xhr.responseText)\n            } else {\n              data.response = xhr.responseText\n            }\n          }\n\n          // 更新\n          file = this.update(file, data)\n\n          // 相应错误\n          if (file.error) {\n            return reject(file.error)\n          }\n\n          // 响应\n          return resolve(file)\n        }\n\n        // 事件\n        xhr.onload = fn\n        xhr.onerror = fn\n        xhr.onabort = fn\n        xhr.ontimeout = fn\n\n        // 超时\n        if (file.timeout) {\n          xhr.timeout = file.timeout\n        }\n\n        // headers\n        for (let key in file.headers) {\n          xhr.setRequestHeader(key, file.headers[key])\n        }\n\n        // 更新 xhr\n        file = this.update(file, { xhr })\n\n        // 开始上传\n        xhr.send(body)\n      })\n    },\n\n\n\n\n    uploadHtml4(_file) {\n      let file = _file\n      let onKeydown = function (e) {\n        if (e.keyCode === 27) {\n          e.preventDefault()\n        }\n      }\n\n      let iframe = document.createElement('iframe')\n      iframe.id = 'upload-iframe-' + file.id\n      iframe.name = 'upload-iframe-' + file.id\n      iframe.src = 'about:blank'\n      iframe.setAttribute('style', 'width:1px;height:1px;top:-999em;position:absolute; margin-top:-999em;')\n\n\n      let form = document.createElement('form')\n\n      form.action = file.postAction\n\n      form.name = 'upload-form-' + file.id\n\n\n      form.setAttribute('method', 'POST')\n      form.setAttribute('target', 'upload-iframe-' + file.id)\n      form.setAttribute('enctype', 'multipart/form-data')\n\n      let value\n      let input\n      for (let key in file.data) {\n        value = file.data[key]\n        if (value && typeof value === 'object' && typeof value.toString !== 'function') {\n          value = JSON.stringify(value)\n        }\n        if (value !== null && value !== undefined) {\n          input = document.createElement('input')\n          input.type = 'hidden'\n          input.name = key\n          form.appendChild(input)\n        }\n      }\n      form.appendChild(file.el)\n\n      document.body.appendChild(iframe).appendChild(form)\n\n\n\n\n      let getResponseData = function () {\n        let doc\n        try {\n          if (iframe.contentWindow) {\n            doc = iframe.contentWindow.document\n          }\n        } catch (err) {\n        }\n        if (!doc) {\n          try {\n            doc = iframe.contentDocument ? iframe.contentDocument : iframe.document\n          } catch (err) {\n            doc = iframe.document\n          }\n        }\n        if (doc && doc.body) {\n          return doc.body.innerHTML\n        }\n        return null\n      }\n\n\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          file = this.update(file, { iframe })\n\n          // 不存在\n          if (!file) {\n            return reject('not_exists')\n          }\n\n          // 定时检查\n          let interval = setInterval(() => {\n            file = this.get(file)\n            if (file && file.fileObject && !file.success && !file.error && file.active) {\n              return\n            }\n\n            if (interval) {\n              clearInterval(interval)\n              interval = false\n            }\n\n            iframe.onabort({ type: file ? 'abort' : 'not_exists' })\n          }, 100)\n\n\n          let complete\n          let fn = (e) => {\n            // 已经处理过了\n            if (complete) {\n              return\n            }\n            complete = true\n\n\n            if (interval) {\n              clearInterval(interval)\n              interval = false\n            }\n\n            // 关闭 esc 事件\n            document.body.removeEventListener('keydown', onKeydown)\n\n            file = this.get(file)\n\n            // 不存在直接响应\n            if (!file) {\n              return reject('not_exists')\n            }\n\n            // 不是文件对象\n            if (!file.fileObject) {\n              return reject('file_object')\n            }\n\n            // 有错误自动响应\n            if (file.error) {\n              return reject(file.error)\n            }\n\n            // 未激活\n            if (!file.active) {\n              return reject('abort')\n            }\n\n            // 已完成 直接相应\n            if (file.success) {\n              return resolve(file)\n            }\n\n            let response = getResponseData()\n            let data = {}\n            switch (e.type) {\n              case 'abort':\n                data.error = 'abort'\n                break\n              case 'error':\n                if (file.error) {\n                  data.error = file.error\n                } else if (response === null) {\n                  data.error = 'network'\n                } else {\n                  data.error = 'denied'\n                }\n                break\n              default:\n                if (file.error) {\n                  data.error = file.error\n                } else if (data === null) {\n                  data.error = 'network'\n                } else {\n                  data.progress = '100.00'\n                }\n            }\n\n            if (response !== null) {\n              if (response && response.substr(0, 1) === '{' && response.substr(response.length - 1, 1) === '}') {\n                try {\n                  response = JSON.parse(response)\n                } catch (err) {\n                }\n              }\n              data.response = response\n            }\n\n            // 更新\n            file = this.update(file, data)\n\n            if (file.error) {\n              return reject(file.error)\n            }\n\n            // 响应\n            return resolve(file)\n          }\n\n\n          // 添加事件\n          iframe.onload = fn\n          iframe.onerror = fn\n          iframe.onabort = fn\n\n\n          // 禁止 esc 键\n          document.body.addEventListener('keydown', onKeydown)\n\n          // 提交\n          form.submit()\n        }, 50)\n      }).then(function (res) {\n        iframe.parentNode && iframe.parentNode.removeChild(iframe)\n        return res\n      }).catch(function (res) {\n        iframe.parentNode && iframe.parentNode.removeChild(iframe)\n        return res\n      })\n    },\n\n\n\n    watchActive(active) {\n      let file\n      let index = 0\n      while ((file = this.files[index])) {\n        index++\n        if (!file.fileObject) {\n          // 不是文件对象\n        } else if (active && !this.destroy) {\n          if (this.uploading >= this.thread || (this.uploading && !this.features.html5)) {\n            break\n          }\n          if (!file.active && !file.error && !file.success) {\n            this.update(file, { active: true })\n          }\n        } else {\n          if (file.active) {\n            this.update(file, { active: false })\n          }\n        }\n      }\n      if (this.uploading === 0) {\n        this.active = false\n      }\n    },\n\n\n    watchDrop(_el) {\n      let el = _el\n      if (!this.features.drop) {\n        return\n      }\n\n      // 移除挂载\n      if (this.dropElement) {\n        try {\n          document.removeEventListener('dragenter', this.onDragenter, false)\n          document.removeEventListener('dragleave', this.onDragleave, false)\n          this.dropElement.removeEventListener('dragover', this.onDragover, false)\n          this.dropElement.removeEventListener('drop', this.onDrop, false)\n        } catch (e) {\n        }\n      }\n\n      if (!el) {\n        el = false\n      } else if (typeof el === 'string') {\n        el = document.querySelector(el) || this.$root.$el.querySelector(el)\n      } else if (el === true) {\n        el = this.$parent.$el\n      }\n\n      this.dropElement = el\n\n      if (this.dropElement) {\n        document.addEventListener('dragenter', this.onDragenter, false)\n        document.addEventListener('dragleave', this.onDragleave, false)\n        this.dropElement.addEventListener('dragover', this.onDragover, false)\n        this.dropElement.addEventListener('drop', this.onDrop, false)\n      }\n    },\n\n\n    onDragenter(e) {\n      e.preventDefault()\n      if (!this.dropActive) {\n        this.dropActive = true\n      }\n    },\n\n    onDragleave(e) {\n      e.preventDefault()\n      if (e.target.nodeName === 'HTML' || (e.screenX === 0 && e.screenY === 0 && !e.fromElement && e.offsetX <= 0)) {\n        this.dropActive = false\n      }\n    },\n\n    onDragover(e) {\n      e.preventDefault()\n    },\n\n    onDrop(e) {\n      e.preventDefault()\n      this.dropActive = false\n      this.addDataTransfer(e.dataTransfer)\n    },\n  }\n}\n</script>\n"],"names":["render","e","$destroy","$parent","addInputFile","target","this","constructor","$el","String","Boolean","Number","multiple","Object","Array","value","input","document","createElement","type","window","FormData","files","webkitdirectory","directory","features","html5","ondrop","drop","maps","$nextTick","$forceUpdate","watchDrop","destroy","active","file","i","length","fileObject","error","success","undefined","watchActive","oldMaps","id","key","newFile","oldFile","emitFile","emitInput","_files","index","addIndex","isArray","addFiles","Blob","size","webkitRelativePath","relativePath","name","Element","el","putAction","postAction","timeout","data","headers","Math","random","toString","substr","emitFilter","maximum","push","clear","newFiles","concat","splice","replace","add","dataTransfer","items","item","getAsEntry","webkitGetAsEntry","getAsFile","Promise","resolve","reject","forEach","_this","getEntry","then","results","entry","path","isFile","isDirectory","_this2","dropDirectory","dirReader","createReader","readEntries","entries","id1","id2","file1","get","file2","index1","indexOf","index2","isPrevent","$emit","uploading","upload","_this3","update","catch","code","message","parseInt","extensions","RegExp","split","map","trim","filter","join","search","uploadPut","uploadHtml5","uploadHtml4","querys","encodeURIComponent","queryString","xhr","XMLHttpRequest","open","uploadXhr","form","File","append","JSON","stringify","filename","_file","body","speedTime","speedLoaded","onprogress","_this4","lengthComputable","speedTime2","round","Date","now","loaded","total","toFixed","interval","setInterval","abort","complete","fn","status","progress","responseText","contentType","getResponseHeader","response","parse","onload","onerror","onabort","ontimeout","setRequestHeader","send","onKeydown","keyCode","preventDefault","iframe","src","setAttribute","action","appendChild","getResponseData","doc","contentWindow","err","contentDocument","innerHTML","_this5","removeEventListener","addEventListener","submit","res","parentNode","removeChild","thread","_el","dropElement","onDragenter","onDragleave","onDragover","onDrop","querySelector","$root","dropActive","nodeName","screenX","screenY","fromElement","offsetX","addDataTransfer"],"mappings":"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"}